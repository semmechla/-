import random
import requests
import telebot
import time
from datetime import datetime, timedelta
from zoneinfo import ZoneInfo

webhook = 'здесь будет дискорд вебхук' # Сюда вставте свой вебхук
bot = telebot.TeleBot("Здесь будет токен бота") # Сюда вставте свой токен полученный у BotFather

def send_to_discord_channel(message, text, answer):
    dt = datetime.now(ZoneInfo("Europe/Moscow"))
    payload={
        "content": (
            f'Человек воспользовался ботом\n'
            f' \n'
            f'Что он написал после команды /gabe и что ему ответил габен:\n'
            f'Вопрос: {text}\n'
            f'Ответ: {answer}'
            f' \n'
            f'Пришло это от:\n'
            '\n'
            f'Username: {message.from_user.username or "Не указан"}\n'
            f'ID: {message.from_user.id or "Не указан"}\n'
            f'Имя: {message.from_user.first_name or "Не указанно"}\n'
            f'Фамилия: {message.from_user.last_name or "Не указанно"}\n'
            f'Дата отправки: {dt.strftime("%Y-%m-%d %H:%M:%S")}'
        ),
        "username": 'Говорящий габен - бот',
        "avatar_url": 'https://i.imgur.com/zhZuUhW.jpeg'
    }
    response = requests.post(webhook, json=payload)

waiting = set()

def gabe():

    perevod_gaben ={
        "yes": ["Да, и не забудь вложить все деньги в новые кейсы — Габен так хочет!", "Однозначно да, время скупать скины и повышать свой уровень доната", "Да, бери всё, что видишь — пусть кошелёк плачет, а Габен улыбается", "Да, но только если ты готов отдать всё, что есть на карте", "Да, купи скин, а если денег нет — бери кредит, Габен не против", "Да, и ещё подкинь пару баксов в Battle Pass, он же того стоит", "Да, гляди не пропусти распродажу — там твои деньги уже ждут", "Да, а если вдруг повезёт — выпадет нож, и всё окупится (ну почти)", "Да, Steam не любит тех, кто жалеет свои деньги", "Да, вкладывайся в скины, пусть друзья завидуют и заваливают донатами", "Да, Габен уже считает твои деньги", "Да, пора снова донатить в любимую игру", "Да, шансы велики, как и твои траты", "Да, именно сейчас твой момент слить всё", "Да, возможно ты получишь легендарку… или нет", "Да, это отличная инвестиция в пиксели", "Да, не забудь похвастаться друзьям", "Да, кейсы сами себя не откроют", "Да, лучше потратить сейчас, чем потом пожалеть", "Да, шанс на нож повысился на 0.0001%", "Да, ты ведь не зря держал эти деньги", "Да, ну а зачем тебе еда и коммуналка?", "Да, даже твой кошелёк это понял", "Да, удача на твоей стороне (в теории)", "Да, и пусть банк подождёт", "Да, твоё будущее — донатное", "Да, а деньги — просто цифры", "Да, игра будет благодарна", "Да, Габен кивает одобрительно", "Да, и вселенная согласна", "Да, звёзды сложились верно", "Да, ты не ошибся адресом", "Да, момент идеальный", "Да, чтобы снова ничего не выпало", "Да, и пусть совесть молчит", "Да, ты обязан это сделать", "Да, это свыше", "Да, иначе как жить-то?", "Да, и пусть баланс плачет", "Да, судьба решила за тебя", "Да, это зов Steam-а", "Да, покупай, пока горячо", "Да, не жди зарплаты", "Да, эти деньги уже не твои", "Да, ты почувствовал зов", "Да, и хватит думать", "Да, интуиция не врёт", "Да, Габен уже ждёт", "Да, ты в шаге от лута", "Да, только не оборачивайся", "Да, мы все тобой гордимся", "Да, сейчас идеальный шанс", "Да, финансы? Какие финансы?", "Да, отдай душу и карту", "Да, чем больше скинов — тем круче", "Да, всё ради красоты инвентаря", "Да, и пусть банкир нервничает", "Да, всё к этому шло", "Да, давно пора", "Да, ещё немного и будет нож", "Да, самое время тратить", "Да, забудь про здравый смысл", "Да, иначе не выпадает", "Да, только не забудь пополнить счёт", "Да, это путь избранного", "Да, поддержи Габена лично", "Да, это будет эпично", "Да, это твой путь", "Да, не стоит отказывать себе", "Да, ты заслужил это", "Да, карта уже греется", "Да, Steam обожает таких, как ты", "Да, ты почти у цели", "Да, ты знаешь, что хочешь", "Да, лутбоксы ждут", "Да, и только да", "Да, безусловно", "Да, и не иначе", "Да, снова да", "Да, это долг", "Да, даже родители поймут", "Да, у тебя талант донатить", "Да, ты уже в игре", "Да, вопрос был лишним", "Да, не задавай вопросов", "Да, это суждено", "Да, ещё парочку", "Да, до ножа рукой подать", "Да, вложись в себя", "Да, ты прокачан", "Да, деньги ушли не зря", "Да, в этом смысл", "Да, ради скина", "Да, всё ради эпика", "Да, снова в бой", "Да, не отступай", "Да, просто нажми купить", "Да, ещё немного и легендарка", "Да, почти jackpot", "Да, и точка", "Да, твой стиль — донат", "Да, ты пример для других", "Да, это просто искусство", "Да, скин важнее еды", "Да, и не вздумай передумать", "Да, почти бесплатно", "Да, идеальное решение", "Да, это твой момент", "Да, не подведи Габена", "Да, твоя жертва принята", "Да, ты одобрен системой", "Да, и вложи ещё пару сотен — не пожалеешь (Габен так сказал)", "Да, и пусть на карте останется только пыль от баланса", "Да, скупай всё — ты же не для красоты копил деньги", "Да, и не забудь оформить подписку на каждую игру", "Да, прямо сейчас — не откладывай страдания кошелька", "Да, Габену уже не хватает на новый трон из золота", "Да, купи себе счастье в виде пикселей", "Да, а если повезёт — выпадет не нож, а наклейка за 3 цента", "Да, и не забудь уговорить друзей донатить тоже", "Да, день без доната — день прожит зря", "Да, балансу конец, но зато у тебя будет фиолетка", "Да, и добавь ещё один кейс... и ещё... и ещё", "Да, даже банкомат уже смирился", "Да, пусть будет больно, но красиво", "Да, инвестируй в то, что обесценится через час", "Да, и попрощайся с зарплатой", "Да, твоя цель — минус баланс, плюс скин", "Да, не позорься, трать как чемпион", "Да, потому что жизнь — это донат", "Да, ты рожден для того, чтобы донатить", "Да, не жди акций — трать сейчас, кайфуй потом (или нет)", "Да, чем больше тратишь — тем ближе нож", "Да, и купи ещё немного кейсов про запас", "Да, и не забудь: чем дороже кейс, тем слаще боль", "Да, ты на верном пути в финансовую яму", "Да, и пусть долги копятся — зато скин красивый", "Да, все нормальные тратят на скины", "Да, у тебя же ещё есть кредитка, верно?", "Да, твой долг — поддержать Габена донатом", "Да, не останавливайся на достигнутом", "Да, не считай деньги — просто трать", "Да, а если не выпадет — купи ещё 10", "Да, лучше кейс в руке, чем деньги на карте", "Да, и ещё одну рулетку в придачу", "Да, сливай до нуля, потом снова", "Да, это твой способ показать любовь к игре", "Да, и пусть родители не знают", "Да, всё ради пикселей", "Да, скины — лучшее вложение (нет)", "Да, не упусти шанс расстаться с деньгами", "Да, пора сделать карту минусовой", "Да, банк не одобрит, зато Габен — да", "Да, и оформим тебе премиум-донатер", "Да, донат — путь избранных", "Да, твой кошелёк не нужен — только инвентарь", "Да, и если выпадет серый — не ной", "Да, трати деньги с гордостью", "Да, и забудь о рациональности", "Да, эти пиксели стоят каждого рубля", "Да, не ради выигрыша — ради процесса страдания", "Да, это не азарт — это стиль жизни", "Да, и если надо — продай лишнюю почку", "Да, без доната ты никто", "Да, вложи душу, тело и карту", "Да, а вдруг выпадет блеск надежды", "Да, жалко денег? А ты кто вообще?", "Да, Габен шлёт тебе лучи благодарности", "Да, и не забудь оформить подписку на страдания", "Да, и каждый клик — шаг к банкротству", "Да, но ты ведь знал, на что шёл", "Да, тебя выбрали — не разочаруй Габена", "Да, сделай это ради кейса", "Да, забудь про здоровье — главное донат", "Да, ты достоин лута, как никто другой", "Да, ведь у тебя всё равно нет плана на жизнь", "Да, и твой скин — это статус", "Да, докажи, что ты истинный донатер", "Да, делай это с азартом, не с умом", "Да, чем больше тратишь, тем громче смех Габена", "Да, и не забудь кричать «ещё!»", "Да, это твой путь — путь пустого баланса", "Да, попробуй — вдруг не выпадет снова", "Да, трать, чтобы забыть о тратах", "Да, тебе не нужно это — но Габену нужно", "Да, и не смотри на цену", "Да, ты просто не умеешь жить без кейсов", "Да, это новая форма аскезы", "Да, твои деньги ждут своей гибели", "Да, и чем быстрее, тем веселее", "Да, прокрути рулетку судьбы", "Да, скин — твоя цель, не пища", "Да, игра благодарна, кошелёк — нет", "Да, крути до победного — то есть до нуля", "Да, и пусть долг смеётся", "Да, ты не человек — ты донат-машина", "Да, забудь о кэше — живи скинами", "Да, ты ждал этого всю жизнь", "Да, включи мозг... потом выключи и донать", "Да, а что, вдруг нож?", "Да, ты близок к легендарному минусу", "Да, и не забудь вернуться завтра", "Да, если не сегодня — то когда?", "Да, ты создан тратить", "Да, просто представь, как друзья завидуют", "Да, а если выпадет — праздник", "Да, не трать время на размышления", "Да, это ведь не твои деньги — уже нет", "Да, будь героем доната", "Да, ты топ-донатер по призванию"],
        "no": ["Нет, но можешь смело отдать все деньги на новые скины — Габен не против", "Нет, но вместо этого лучше купи сундук, деньги всё равно потратишь", "Нет, а пока копи на нож — всё равно придётся платить", "Нет, но не волнуйся, скоро выйдет новый кейс, и ты всё потратишь", "Нет, но бери кредит — Габен любит, когда ты щедро инвестируешь", "Нет, лучше потрать всё на донаты, чем жалеть потом", "Нет, а вот потратить деньги на скин — хорошая идея", "Нет, но не держи деньги в кошельке — они для Габена слишком скучны", "Нет, а ещё лучше отдай все накопления в магазин Steam", "Нет, но ты всё равно найдёшь способ потратить всё до копейки", "Нет, но ты всё равно задонатишь", "Нет, но деньги уже списаны", "Нет, но баланс снова упал", "Нет, но нож всё ещё манит", "Нет, но неси деньги сюда", "Нет, но желание сильнее", "Нет, но это не помешает тебе", "Нет, но уже поздно", "Нет, но ты же понимаешь", "Нет, но соблазн велик", "Нет, но всё равно жми купить", "Нет, но Steam уже открыл кейс", "Нет, но карточка уже дрожит", "Нет, но шанс остался", "Нет, но не сдавайся", "Нет, но ты близко", "Нет, но сегодня твой день", "Нет, но кто тебя остановит?", "Нет, но мы оба знаем правду", "Нет, но что-то внутри говорит да", "Нет, но нож уже почти твой", "Нет, но ты же донатер", "Нет, но инвентарь скучает", "Нет, но обнова близко", "Нет, но просто еще один кейс", "Нет, но банк всё поймёт", "Нет, но ты готов", "Нет, но мы верим в тебя", "Нет, но кредит — это не страшно", "Нет, но карта не скажет нет", "Нет, но шансы в твою пользу", "Нет, но подумай ещё раз", "Нет, но кто сказал что нельзя", "Нет, но ты уже решил", "Нет, но логика тебе не нужна", "Нет, но здравый смысл — не для тебя", "Нет, но ты почти победил", "Нет, но ты же не слабак", "Нет, но только не сейчас", "Нет, но время придёт", "Нет, но всё впереди", "Нет, но подготовь деньги", "Нет, но Габен ждёт", "Нет, но это временно", "Нет, но будет да", "Нет, но ты знаешь что делать", "Нет, но совесть молчит", "Нет, но сердце соглашается", "Нет, но скидки не вечны", "Нет, но скоро снова", "Нет, но кошелёк трепещет", "Нет, но Steam всегда рядом", "Нет, но один кейс — не страшно", "Нет, но у тебя талант", "Нет, но скоро обнова", "Нет, но ты не сдержишься", "Нет, но стоит попробовать", "Нет, но на балансе ещё есть", "Нет, но отговорки не помогут", "Нет, но ты уже открыл", "Нет, но слишком поздно", "Нет, но азарт сильнее", "Нет, но всё равно хочется", "Нет, но для тебя — исключение", "Нет, но так было задумано", "Нет, но это не навсегда", "Нет, но такова судьба", "Нет, но завтра точно да", "Нет, но кто считает деньги", "Нет, но для Габена — всегда да", "Нет, но карта рядом", "Нет, но ты не остановишься", "Нет, но ты почти убедил всех", "Нет, но сам понимаешь", "Нет, но кейс ждёт", "Нет, но ты уже открыл один", "Нет, но было близко", "Нет, но баланс жаждет", "Нет, но ты уже в игре", "Нет, но так интереснее", "Нет, но тебе можно", "Нет, но ты особенный", "Нет, но будет иначе", "Нет, но всё возможно", "Нет, но мы всё видели", "Нет, но скоро выйдет нож", "Нет, но Steam тебя манит", "Нет, но деньги — это инструмент", "Нет, но ты всё равно хочешь", "Нет, но жми ещё раз", "Нет, но у тебя получится", "Нет, но звёзды не сошлись", "Нет, но ты почти там", "Нет, но удача рядом", "Нет, но не сдавайся", "Нет, но ещё одна попытка", "Нет, но ты почти прав", "Нет, но игра зовёт", "Нет, но нельзя остановиться", "Нет, но это был тест", "Нет, но шанс не упущен", "Нет, но внутри — да", "Нет, но ты всё равно потратишь — мы оба это знаем", "Нет, но ты уже достал карту, да?", "Нет, но если не сейчас, то через пять минут", "Нет, но кейсы сами себя не купят", "Нет, но зачем останавливаться?", "Нет, но твои деньги уже попрощались с тобой", "Нет, но баланс не бесконечен — проверим?", "Нет, но если потратишь — никто не осудит", "Нет, но вдруг выпадет именно сейчас?", "Нет, но донат — это ведь привычка", "Нет, но твоя карта плачет от ожидания", "Нет, но ты всё равно жмёшь 'пополнить'", "Нет, но зачем эти деньги в жизни?", "Нет, но не тратить — преступление перед Габеном", "Нет, но кредит не потратится сам", "Нет, но ты уже нажал 'купить', да?", "Нет, но соблазн сильнее логики", "Нет, но ради скина — можно и потерпеть", "Нет, но разум слаб перед скинами", "Нет, но разве тебе нужен повод?", "Нет, но ты знаешь, что будешь жалеть... если не купишь", "Нет, но мы оба знаем, что это ложь", "Нет, но нет значит да", "Нет, но это временно", "Нет, но акция заканчивается, поторопись", "Нет, но вдруг повезёт?", "Нет, но нож не выпадет без жертв", "Нет, но ты не первый — и не последний", "Нет, но ты родился донатить", "Нет, но это не остановит тебя", "Нет, но одна покупка — не трагедия", "Нет, но это уже не твои деньги", "Нет, но Steam чувствует твою нерешительность", "Нет, но кейс скучает", "Нет, но карта ждёт", "Нет, но тебе давно пора", "Нет, но ты создан для этого", "Нет, но где твой азарт?", "Нет, но не бойся нищеты — бойся скуки", "Нет, но ради уважения", "Нет, но посмотри на свой инвентарь — он пуст", "Нет, но ты же не слабак", "Нет, но зато будет скин", "Нет, но каждый отказ — минус к удаче", "Нет, но так не интересно", "Нет, но баланс ждёт своей судьбы", "Нет, но долги — это модно", "Нет, но ты ведь уже решил", "Нет, но у тебя же карта не заблокирована", "Нет, но ради прокрута стоит рискнуть", "Нет, но это же всего лишь деньги", "Нет, но друзья поймут", "Нет, но остаться с деньгами — скучно", "Нет, но скин красивее еды", "Нет, но баланс — дело наживное", "Нет, но совесть отключена", "Нет, но тебя ничего не остановит", "Нет, но каждый кейс приближает к ножу", "Нет, но откуда у тебя вообще сомнения?", "Нет, но ты же знал, к чему это ведёт", "Нет, но не будь таким здравым", "Нет, но ещё чуть-чуть", "Нет, но вдруг выпадет наклейка?", "Нет, но это испытание, и ты его провалишь", "Нет, но это всего лишь один клик", "Нет, но ты уже проиграл битву с собой", "Нет, но твоя душа продана", "Нет, но Габен доволен", "Нет, но это глупо — и именно поэтому ты сделаешь это", "Нет, но кто сказал, что слушать нужно?", "Нет, но у тебя ещё остались деньги?", "Нет, но каждый 'нет' делает тебя слабее", "Нет, но мышка уже навелась на кнопку", "Нет, но инвентарь требует свежей крови", "Нет, но это часть твоей личности", "Нет, но это внутренняя борьба", "Нет, но ты не победишь", "Нет, но все так делают", "Нет, но ты не хуже остальных", "Нет, но ты обязан попытаться", "Нет, но у тебя нет выбора", "Нет, но деньги — для слабаков", "Нет, но донат — для легенд", "Нет, но так велит традиция", "Нет, но ты знаешь, что это 'да'", "Нет, но мозг не нужен — только карта", "Нет, но эмоции важнее логики", "Нет, но шанс живёт в каждом кейсе", "Нет, но кто остановит тебя?", "Нет, но ты почти там", "Нет, но это ещё не конец", "Нет, но соблазн — двигатель прогресса", "Нет, но инвентарь просит", "Нет, но ты уже готов", "Нет, но деньги лишние?", "Нет, но этот скин сам себя не купит", "Нет, но азарт — сильнее разума", "Нет, но Габен одобряет", "Нет, но ещё один шанс", "Нет, но всё равно жми", "Нет, но потом спасибо скажешь", "Нет, но ведь интересно, что выпадет?"]
    }

    temp = ["yes", "no"]
    grab = random.choice(temp)

    last_otvet_gaben = random.choice(perevod_gaben.get(grab))
    return last_otvet_gaben

@bot.message_handler(commands=['start'])
def reag_start(message):
    bot.send_message(message.chat.id, "Привет тебя встречает бот 'Говорящий габен' Это секретный бот для связи с габеном\n"
                                      "Введите /gabe чтобы спросить у габена")


@bot.message_handler(commands=['gabe'])
def game(message):
    waiting.add(message.chat.id)
    bot.send_message(message.chat.id, "Введите ваш вопрос габену (1 вопрос стоит 5$):")

"""
    Я бы мог реализовать счёт денег и чтобы они списывались как и написано (5$), но мне лень. хотите сами допишите
"""

@bot.message_handler(func=lambda message: True, content_types=['text'])
def handle_text(message):
    if message.chat.id in waiting:
        waiting.remove(message.chat.id)
        text = message.text
        answer = gabe()
        bot.reply_to(message, f"Габен отвечает: {answer}")
        send_to_discord_channel(message, text, answer)

    else:
        bot.send_message(message.chat.id, "Напиши /gabe, чтобы задать вопрос Габену.")


# Констукция для бесконечной работы бота. При любых условиях, он будет усердно переподключатся
while True:
    try:
        bot.polling(none_stop=True, interval=0, timeout=20)
    except Exception as e:
        print(f"Ошибка: {e} бот сейчас перезапустится")
        time.sleep(3)
        print("Бот перезапущен и работает корректно")

